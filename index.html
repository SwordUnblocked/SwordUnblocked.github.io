<!DOCTYPE html>
<html>
<head>
    <title>Restricted Access Page</title>
    <style>
        #overlay {
            position: fixed;
            display: flex;
            justify-content: center;
            align-items: center;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0,0,0,0.5); /* Black with transparency */
            z-index: 2;
            text-align: center;
        }
        #content {
            display: none;
            z-index: 1;
        }
    </style>
</head>
<body>
    <div id="overlay">
        <div id="signin-button"></div>
    </div>
    <div id="content">
        <!-- Your main content goes here -->
        <h1>Welcome, authenticated user!</h1>
    </div>

    <script src="https://apis.google.com/js/platform.js" async defer></script>
    <script>
        let clientId = 'YXRhci5hc3FAZ21haWwuY29t'; // Replace with your Client ID
        let allowedHashes = ['8b0f7932738dda6bd5b31cadcb462e0b0cd2024e4df6ea7c6952effdfc30af15', 'hash2', 'hash3']; // Replace with your hashes

        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            var userEmail = profile.getEmail();
            var userHash = hashEmail(userEmail); // Implement this function based on your hashing algorithm

            if (allowedHashes.includes(userHash)) {
                // Hide the overlay
                document.getElementById('overlay').style.display = 'none';

                // Show the main content
                document.getElementById('content').style.display = 'block';
            } else {
                console.log("Access Denied: Your account is not authorized.");
            }
        }

        function hashEmail(email) {
            // Implement a hashing function here
            // For demo purposes, let's just return a simple transformation of the email
            return btoa(email); // Base64 encoding (Not a secure hash)
        }

        function onFailure(error) {
            console.log(error);
        }

        function renderButton() {
            gapi.signin2.render('signin-button', {
                'scope': 'profile email',
                'width': 240,
                'height': 50,
                'longtitle': true,
                'theme': 'dark',
                'onsuccess': onSignIn,
                'onfailure': onFailure
            });
        }

        gapi.load('auth2', function() {
            gapi.auth2.init({
                client_id: clientId
            }).then(renderButton);
        });
    </script>
</body>
</html>

<!DOCTYPE html>
<html>
<head>
    <title>GitHub Pages with Google Login and Hash Check</title>
</head>
<body>
    <div id="protected-content" style="display:none;">
        <!-- Your protected content goes here -->
        <h1>Welcome, authenticated user!</h1>
    </div>
    <div id="signin-button"></div>

    <script src="https://apis.google.com/js/platform.js?onload=initGoogleAPI" async defer></script>
    <script>
        let clientId = 'YXRhci5hc3FAZ21haWwuY29t';
        const expectedHash = '8b0f7932738dda6bd5b31cadcb462e0b0cd2024e4df6ea7c6952effdfc30af15'; // Replace with your expected hash

        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            let emailHash = simpleHash(profile.getEmail());

            if (emailHash === expectedHash) {
                // Show the protected content
                document.getElementById('protected-content').style.display = 'block';
            }

            // Hide the login button
            document.getElementById('signin-button').style.display = 'none';
        }

        function onFailure(error) {
            console.log(error);
        }

        function renderButton() {
            gapi.signin2.render('signin-button', {
                'scope': 'profile email',
                'width': 240,
                'height': 50,
                'longtitle': true,
                'theme': 'dark',
                'onsuccess': onSignIn,
                'onfailure': onFailure
            });
        }

        function initGoogleAPI() {
            gapi.load('auth2', function() {
                gapi.auth2.init({
                    client_id: clientId
                }).then(renderButton);
            });
        }

        function simpleHash(str) {
            let hash = 0;
            for (let i = 0; i < str.length; i++) {
                let char = str.charCodeAt(i);
                hash = ((hash << 5) - hash) + char;
                hash = hash & hash; // Convert to 32bit integer
            }
            console.log(hash)
            return hash;
        }
    </script>
</body>
</html>
