<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Security-Policy" content="
        default-src 'none'; 
        script-src 'self' https://apis.google.com https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js;
        style-src 'self' 'unsafe-inline'; 
        img-src 'self'; 
        connect-src 'self'; 
        font-src 'self';">
    <title>Skibidi Dop Dop Dop yes yes</title>
</head>
<body>
    <div id="content" style="display:none;">
        <h1>Welcome, authenticated user!</h1>
    </div>
    <div id="signin-button">Sign In</div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/crypto-js/4.0.0/crypto-js.min.js"></script>
    <script src="https://apis.google.com/js/platform.js?onload=initGoogleAPI" async defer></script>
    <script>
        let clientId = '692476350843-4jcjp4s3emmjs4s4o058jime0dfo9c8a.apps.googleusercontent.com';

        let authorizedHashes = [
            '8b0f7932738dda6bd5b31cadcb462e0b0cd2024e4df6ea7c6952effdfc30af15',
            'another_sha256_hash'
        ];

        function onSignIn(googleUser) {
            var profile = googleUser.getBasicProfile();
            let email = profile.getEmail();
            let emailHash = CryptoJS.SHA256(email).toString();

            if (authorizedHashes.includes(emailHash)) {
                document.getElementById('content').style.display = 'block';
            } else {
                document.getElementById('content').style.display = 'none';
            }

            document.getElementById('signin-button').style.display = 'none';
        }

        function onFailure(error) {
            console.error('Sign-in failed:', error);
        }

        function renderButton() {
            gapi.signin2.render('signin-button', {
                'scope': 'profile email',
                'width': 240,
                'height': 50,
                'longtitle': true,
                'theme': 'dark',
                'onsuccess': onSignIn,
                'onfailure': onFailure
            });
        }

        function initGoogleAPI() {
            gapi.load('auth2', function() {
                gapi.auth2.init({
                    client_id: clientId
                }).then(renderButton);
            });
        }

        document.getElementById('signin-button').addEventListener('click', function() {
            var auth2 = gapi.auth2.getAuthInstance();
            auth2.signIn().then(function (googleUser) {
                onSignIn(googleUser);
            }, function (error) {
                onFailure(error);
            });
        });
    </script>
</body>
</html>
